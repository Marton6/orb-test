description: >
  Install the SecretHub CLI.
parameters:
  version:
    type: string
    default: "latest"
    description: "Version of the SecretHub CLI"
  install-path:
    type: string
    default: /usr/local/bin
    description: "Path to install SecretHub CLI to"
  shell:
    type: string
    default: /bin/sh

steps:
  - run:
      name: "Install SecretHub CLI"
      shell: << parameters.shell >>
      command: |
        sudo apt-get update
        sudo apt-get -y upgrade

        wget https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz


        sudo tar -xvf go1.13.3.linux-amd64.tar.gz
        sudo mv go /usr/local

        export GOROOT=/usr/local/go

        export GOPATH=$HOME

        export PATH=$GOPATH/bin:$GOROOT/bin:$PATH

        git clone https://github.com/secrethub/secrethub-cli.git
        git checkout feature/env-var-references
        cd secrethub-cli
        make install
        cd ..
        rm -rf secrethub-cli
